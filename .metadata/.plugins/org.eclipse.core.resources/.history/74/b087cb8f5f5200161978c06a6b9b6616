



import java.util.regex.Pattern;
import java.util.concurrent.TimeUnit;
import org.junit.*;
import static org.junit.Assert.*;
import static org.hamcrest.CoreMatchers.*;
import org.openqa.selenium.*;
import org.openqa.selenium.firefox.FirefoxDriver;
import org.openqa.selenium.support.ui.Select;

public class CRM {
  public WebDriver driver;
  public String baseUrl;
  public boolean acceptNextAlert = true;
  public StringBuffer verificationErrors = new StringBuffer();

  @Before
  public void setUp() throws Exception {
    driver = new FirefoxDriver();
    baseUrl = "http://192.168.101.186/";
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);
  }

  @Test
  public void testUntitled() throws Exception {
    driver.get(baseUrl + "/login.php");
    driver.findElement(By.id("password")).clear();
    driver.findElement(By.id("password")).sendKeys("welcome");
    driver.findElement(By.id("email")).clear();
    driver.findElement(By.id("email")).sendKeys("virendra.bhati@asergis.in");
    driver.findElement(By.id("submit")).click();
    driver.findElement(By.linkText("Admin Panel")).click();
    driver.findElement(By.linkText("CRM")).click();
    driver.findElement(By.linkText("Add Customer")).click();
    driver.findElement(By.id("company_name")).clear();
    driver.findElement(By.id("company_name")).sendKeys("Selenium Automation Test1");
    driver.findElement(By.id("crm_cudtomer_email_id")).clear();
    driver.findElement(By.id("crm_cudtomer_email_id")).sendKeys("automation001@mailinator.com");
    new Select(driver.findElement(By.id("id_industry_master"))).selectByVisibleText("Advocates");
    driver.findElement(By.id("corporate_contact_no")).clear();
    driver.findElement(By.id("corporate_contact_no")).sendKeys("899456464645");
    driver.findElement(By.id("crm_cpd_person_name")).clear();
    driver.findElement(By.id("crm_cpd_person_name")).sendKeys("Selenium Guy");
    driver.findElement(By.id("crm_cpd_email_id")).clear();
    driver.findElement(By.id("crm_cpd_email_id")).sendKeys("automation001@mailinator.com");
    driver.findElement(By.id("crm_cpd_contact_no")).clear();
    driver.findElement(By.id("crm_cpd_contact_no")).sendKeys("98995288745");
    new Select(driver.findElement(By.id("crm_cpd_designation"))).selectByVisibleText("IT");
    driver.findElement(By.cssSelector("#sizzle-1469089901100 > div.ibox-title > div.ibox-tools > a.collapse-link > i.fa.fa-chevron-up")).click();
    new Select(driver.findElement(By.id("account_manager"))).selectByVisibleText("Anil Test2");
    driver.findElement(By.xpath("//input[@value='Submit Customer Detail']")).click();
    driver.findElement(By.linkText("Log out")).click();
  }

  @After
  
/*  The tearDown() method is used to restablish the state prior to the test.
 *  This is why it has the Junit clause @after. 
 *  This function will be called after every test execution in that class. 
 *  You can also use a setUp() method with a @Before clause to prepare every test.
    The first line of the method: driver.quit(); closes the browser (aka webdriver). 
    Next ones check if there is a non-empty error string, and if it exists, it makes the test fail.*/
  public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
      fail(verificationErrorString);
    }
  }

  public boolean isElementPresent() {
    try {
      driver.findElement(By.xpath(".//*[@id='page-wrapper']/div[1]/nav/ul/li[3]/a"));
      return true;
    } catch (NoSuchElementException e) {
      return false;
    }
  }

  public boolean isAlertPresent() {
    try {
      driver.switchTo().alert();
      return true;
    } catch (NoAlertPresentException e) {
      return false;
    }
  }

  public String closeAlertAndGetItsText() {
    try {
      Alert alert = driver.switchTo().alert();
      String alertText = alert.getText();
      if (acceptNextAlert) {
        alert.accept();
      } else {
        alert.dismiss();
      }
      return alertText;
    } finally {
      acceptNextAlert = true;
    }
  }
}
